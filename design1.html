<!DOCTYPE html>
<html lang="ar">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-YB8D7PR8W7"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-YB8D7PR8W7');
  </script>
  <meta charset="utf-8"/>
  <title>تصميم 1</title>
  <link href="style.css" rel="stylesheet"/>
</head>
<body>
  <div class="logo-bar">
    <img src="images/eid1446-001.png" alt="كل عام وأنتم بخير">
  </div>

  <h1>اكتب اسمك واختر الخط</h1>

  <input id="nameInput" placeholder="اكتب اسمك هنا" type="text"/><br/><br/>

  <label>اختر الخط:</label>
  <select id="fontSelect">
    <option value="Amiri">Amiri</option>
    <option selected value="Cairo">Cairo</option>
    <option value="Tajawal">Tajawal</option>
  </select>

  <br/><br/>

  <button onclick="generateImage(1);">عرض البطاقة</button>
  <a class="button" href="index.html">↩ العودة للرئيسية</a>

  <br/><br/>

  <canvas id="canvas" style="display:none; width:100%; height:auto;"></canvas>

  <br/>
  <a class="button" download="بطاقة_العيد.png" id="downloadBtn" style="display:none;">تحميل البطاقة</a>

<script>
function generateImage(designNumber) {
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const name = document.getElementById('nameInput').value;
  const selectedFont = document.getElementById('fontSelect').value;
  const img = new Image();
  img.src = `images/design${designNumber}.jpg`;

  img.onload = async function () {
    canvas.width = img.width;
    canvas.height = img.height;

    // الآن نحسب الإعدادات بعد ما عرفنا أبعاد الصورة
    const designSettings = {
      1: { fontSize: 28, fontColor: '#feffff', x: img.width * 0.7, y: 1155 },
      2: { fontSize: 42, fontColor: '#CC0000', x: img.width * 0.7, y: 460 },
      3: { fontSize: 34, fontColor: '#333333', x: img.width * 0.3, y: 530 },
      4: { fontSize: 40, fontColor: '#000000', x: 100, y: 480 },
      5: { fontSize: 36, fontColor: '#3366CC', x: img.width / 2, y: 510 },
      6: { fontSize: 38, fontColor: '#FF6600', x: img.width - 100, y: 500 }
    };

    const settings = designSettings[designNumber] || { fontSize: 36, fontColor: '#006699', x: img.width / 2, y: 500 };

    await document.fonts.load(`${settings.fontSize}px ${selectedFont}`);
    
    drawCard();

    // إعادة رسم بعد 100ms لضمان أن الخط تم تحميله
    setTimeout(drawCard, 100);

    function drawCard() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      ctx.font = `bold ${settings.fontSize}px ${selectedFont}`;
      ctx.fillStyle = settings.fontColor;
      ctx.textAlign = 'center';
      ctx.fillText(name, settings.x, settings.y);
      canvas.style.display = 'block';

      const downloadBtn = document.getElementById('downloadBtn');
      downloadBtn.href = canvas.toDataURL();
      downloadBtn.style.display = 'inline-block';
    }
  };
}
</script>


  <div style="margin-top: 20px;">
    <img src="https://visitor-badge.laobi.icu/badge?page_id=eid-cards.design1" />
  </div>

  <footer>
    © 2025 جميع الحقوق محفوظة لأبي تميم
  </footer>
</body>
</html>
